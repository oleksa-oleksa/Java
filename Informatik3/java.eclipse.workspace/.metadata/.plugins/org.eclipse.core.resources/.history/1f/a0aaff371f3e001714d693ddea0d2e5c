package in3.a07;

import java.io.PrintWriter;
import java.util.HashSet;
import java.util.Locale;
import java.util.Scanner;
import java.util.Set;

import lernhilfe2013ws.io.DirtyFileReader;
import lernhilfe2013ws.io.DirtyFileWriter;
import lernhilfe2013ws.objectPlay.Factory;

// TODO Write the class Person instead of the used before class

public class Person {

	public static void main(String[] args) {
		Locale.setDefault(Locale.US);
		Personen[] myTestPersons = Factory.createTestPersons();
		Set<Personen> personSet = new HashSet<Personen>();
		String personsB = "./testfiles/persons_b.txt";
		
		for (int i = 0; i < myTestPersons.length; i++){
			personSet.add(myTestPersons[i]);
		}
		PrintWriter out = new PrintWriter(System.out, true);
		printPersons(personSet, out);
		printPersons(personSet, personsB);
		demoMengenOperationen();
	}
	
	public static void printPersons(Set<Personen> persons, PrintWriter out){
		// converting set back to array
		Personen[] printPersons = new Personen[persons.size()];
		persons.toArray(printPersons);
		for (int i = 0; i < printPersons.length; i++){
			Personen p = printPersons[i];
			out.format("%s %s %d%n", p.getVorname(), p.getNachname(), p.getGeburtsjahr());
		}
	}
	
	public static void printPersons(Set<Personen> persons, String filename){
		PrintWriter fout = new PrintWriter(new DirtyFileWriter(filename));
		printPersons(persons, fout);
		fout.flush();
		fout.close();
	}
	
	public static Personen createPerson(Scanner in){
		String name = in.next();
		String familyName = in.next();
		int year = in.nextInt();
		Personen newHuman = new Personen(name, familyName, year);
		return newHuman;
	}
	
	public static Set<Personen> getPersonsFrom(Scanner in){
		Set<Personen> people = new HashSet<Personen>();
		while (in.hasNext()){
			Personen p = createPerson(in);
			people.add(p);
		}
		return people;
	}
	
	public static Set<Personen> getPersonsFrom(String filename){
		DirtyFileReader dfr = new DirtyFileReader(filename);
		Scanner in = new Scanner(dfr);
		return getPersonsFrom(in);
	}
	
	public static void demoMengenOperationen(){
		Set<Personen> sportFriends = getPersonsFrom("./persondata/sportfreunde.txt");
		Set<Personen> uniFriends = getPersonsFrom("./persondata/kommilitonen.txt");
		
		// Intersection
		Set<Personen> interSet = new HashSet<Personen>(sportFriends);
		interSet.retainAll(uniFriends);
		printPersons(interSet, "./persondata/SundK.txt");
		
		// Difference
		Set<Personen> diffSet = new HashSet<Personen>(uniFriends);
		diffSet.remove(sportFriends);
		printPersons(diffSet, "./persondata/KaberNichtS.txt");
		
		// Union
		Set<Personen> unionSet = getPersonsFrom("./testfiles/persons_b.txt");
		unionSet.addAll(uniFriends);
		printPersons(unionSet, "./persondata/TvereinigtK.txt");
	}
}


